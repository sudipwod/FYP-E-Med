{% comment %} {% extends "basic.html" %} {% endcomment %}
{% load static %}

<!doctype html>
<html lang="en">
  <head>
  
  
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge"> 


    <script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>

    <!-- Bootstrap CSS -->
  
    <script src="{% static 'jquery.js' %}"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/bootstrap.min.css' %}">
    
   <title>E-Med</title>
   
   <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/bootstrap.min.css' %}">
   <link rel="stylesheet" href="{% static 'homepage/css.css' %}">

   <!-- Templated index fie css -->

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>E-Med</title>
    <link rel="icon" href="img/favicon.png">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/bootstrap.min.css' %}">
    <!-- animate CSS -->
    <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/animate.css' %}">
    <!-- owl carousel CSS -->
    <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/owl.carousel.min.css' %}">
    <!-- themify CSS -->
    <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/themify-icons.css' %}">
    <!-- flaticon CSS -->
    <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/flaticon.css' %}">
    <!-- magnific popup CSS -->
    <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/magnific-popup.css' %}">
    <!-- nice select CSS -->
    <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/nice-select.css' %}">
    <!-- swiper CSS -->
    <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/slick.css' %}">
    <!-- style CSS -->
    <link rel="stylesheet" href="{% static 'homepage/bootstrap/css/style.css' %}">


  
  <!-- templated index file css end -->
    

   
  <style>

   .img {
    position: relative;
    float: left;
    width:  200px;
    height: 200px;
    background-position: 100% 100%;
    background-repeat:   no-repeat;
    background-size:     cover;
}


  body{

  background-image: url( "{% static 'homepage/bootstrap/img/new_bg.JPG' %}");
  background-attachment: fixed;
  opacity: 0.93;
  background-repeat: no-repeat;
  
  background-size:cover;


  }


</style>






  
  </head>



<body>
    <!--::header part start::-->
  <header class="main_menu home_menu">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-lg-12">
          <nav class="navbar navbar-expand-lg navbar-light">
            <a class="navbar-brand" href="{% url 'home' %}"> <img src="{% static 'homepage/bootstrap/img/logo.png' %}" alt="logo"> </a>
              <button class="navbar-toggler" type="button" data-toggle="collapse"
                  data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                  aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
              </button>

                <div class="collapse navbar-collapse main-menu-item justify-content-center" id="navbarSupportedContent">
                  <ul class="navbar-nav align-items-center">
                    <li class="nav-item active">
                      <a class="nav-link" href="{% url 'home' %}">Home</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="{% url 'about' %}">About</a>
                    </li>
                    
                    <li class="nav-item">
                      <a class="nav-link" href="{% url 'contact' %}">Contact</a>
                    </li>

                    {% if user.is_authenticated %}
                      
                    {% if user.patient %}
    
                    <ul class="navbar-nav">
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          {{user.username}}
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                          <a class="dropdown-item" href="{% url 'patient_ui' %}">view profile</a>
                          
                          <div class="dropdown-divider"></div>
                          <a class="dropdown-item" href="{% url 'logout' %}">Log out</a>
                        </div>
                      </li>
                    </ul>
    
                    {% endif %}
                    
                    {% if user.doctor  %}
    
                    <ul class="navbar-nav">
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          Dr. {{user.username}}
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                          <a class="dropdown-item" href="{% url 'doctor_ui' %}">view profile</a>
                          
                          <div class="dropdown-divider"></div>
                          <a class="dropdown-item" href="{% url 'logout' %}">Log out</a>
                        </div>
                      </li>
                    </ul>
    
                    {% endif %}
    

             
                    {% else %}
                    
                    <form class="form-inline my-2 my-lg-0">
					    
                      <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown"
                            role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Sign In
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="{% url 'sign_in_patient' %}">Sign In as Patient</a>
                            <a class="dropdown-item" href="{% url 'sign_in_doctor' %}">Sign In as Doctor</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown"
                          role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                           Sign Up
                      </a>
                      <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                          <a class="dropdown-item" href="{% url 'signup_patient' %}">Sign Up as Patient</a>
                          <a class="dropdown-item" href="{% url 'signup_doctor' %}">Sign Up as Doctor</a>
                      </div>
                  </li>
                    
                     
                    </form>
                    
                    {% endif %}
    
                </ul>
            </div>
        </nav> 
      
        </div>
      </div>
    </div>  
  </header> 

 
{% block head %}

<link rel="stylesheet" type="text/css" href="{% static 'patient/checkdisease/dps.css' %}">    
 

<br><br><br><br><br><br><br>
<script>

  /* When the user clicks on the button,
  toggle between hiding and showing the dropdown content */
  function Functionshow() {
    
    document.getElementById("searchbar").value = '';
    document.getElementById("myDropdown").classList.toggle("show");
     search_symptoms();
    
  }
  
  
  // Close the dropdown menu if the user clicks outside of it
  window.onclick = function(event) {
    if (!event.target.matches('.btn')) {
      if (!event.target.matches('.searchbardiv')){
        if (!event.target.matches('.searchbar')){
  
      var dropdowns = document.getElementsByClassName("drop-content");
      var i;
      for (i = 0; i < dropdowns.length; i++) {
        
        var openDropdown = dropdowns[i];
        if (openDropdown.classList.contains('show')) {
          openDropdown.classList.remove('show');
        }
      }
    }
  }
  }
  }
  
    function Functionsymptoms(name) {
      var newItem = document.createElement("TEXTAREA");
      newItem.innerText = name;
      newItem.setAttribute("id","symptoms");
      
      newItem.setAttribute("class","symptoms");
      document.getElementById("sympbox").appendChild(newItem);
      
    }
  
   
    //var elements = document.getElementsByClassName("symptoms");
  
  
    function search_symptoms() { 
      let input = document.getElementById('searchbar').value 
      input=input.toLowerCase(); 
      let x = document.getElementsByClassName('dropdown-item'); 
        
      for (i = 0; i < x.length; i++) {  
          if (!x[i].innerHTML.toLowerCase().includes(input)) { 
              x[i].style.display="none"; 
          } 
          else { 
              x[i].style.display="inline-block";                  
          } 
      } 
  } 
  
  
  $(document).ready( function(){
  
  
  $("#predict").click(function () {
    event.preventDefault();
  
    var symptoms = document.getElementsByClassName("symptoms");
    var noofsym = symptoms.length;
    var symlist=[];
  
    if(noofsym == 0){
       alert(" please add some symptoms ");
    }
  
    else {
  
    for(i=0;i<symptoms.length;i++){
      symlist[i]=symptoms[i].value;
    }
    
  
  
    $("#resultdiv").show("slow");
    $('html,body').animate({
      scrollTop: $("#resultdiv").offset().top},
      'slow');
         
  
  
  
    $.ajax({
        url: 'checkdisease',
        type: "POST",
        data: { "noofsym" : noofsym,
                "symptoms" :symlist,
                csrfmiddlewaretoken : $('input[name=csrfmiddlewaretoken]').val()
        },
        dataType: 'json',
  
        success: function (data) {
          document.getElementById('diseasefield').innerText = data["predicteddisease"];
          document.getElementById('percentage').innerText = data["confidencescore"]+"%";
          percent=data["confidencescore"];
          disease=data["predicteddisease"];
  
          $('#percentage').css('width', percent + "%");
  
          document.getElementById('diseasesearch').innerText = data["predicteddisease"];
  
          $("#href").attr("href","https://www.google.com/search?q="+ disease +"");
  
          
          document.getElementById('consultdoctor').innerText = data["consultdoctor"];
          document.getElementById('hospital').innerText = data["hospital"];
          document.getElementById('remedy').innerText = data["remedy"];
  
        }
        
      });
  
    }
  
    });
  
  
  
  });
  
  </script>
  
  
  
  {% endblock %}
  
  
  
  
  
  
  
  
  
  {% block body %}
  
  
  
  
  
  <div class="container">
        <!-- 
    
    <div class="dropdown">
      <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Dropdown button
      </button>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        <a class="dropdown-item" href="#">Action</a>
        <a class="dropdown-item" href="#">Another action</a>
        <a class="dropdown-item" href="#">Something else here</a>
      </div>
    </div> -->
  
  
    <div class="container">
      <br>
      <div class="text-center"> 
        <h3>
            Identify possible conditions and treatment related to your symptoms.
        </h3><br>
              <button onclick="Functionshow()" class="btn btn-primary dropdown-toggle">Add symptoms</button>
      </div>
    </div >
  
    <div id="myDropdown" class="drop-content">
  
          <div id="searchbardiv" class="searchbardiv">    
        
              <input id="searchbar" class="searchbar" onkeyup="search_symptoms()" type="text"
                name="search" placeholder=" Search symptoms.. "> <br>
          </div> 
  
          <div class="container" id="container-dropdown">
              {% for i in list2 %}
              
              <a class="dropdown-item" onclick="Functionsymptoms(this.textContent)">{{i}}</a>
              
              {% endfor %}
          </div>
    </div>
          
        
      
  
  
  
      
  <br><br>
    <div class="text-center">
          <div class="card" id= "symptoms-box">
      
        {% csrf_token %}
              <div class="card-header">Symptoms list -</div>
                      <div class="card-body" id="sympbox" >
                      </div>
                            <br>
                            <div class="card-footer">
                                  <button id="predict" class="btn btn-success">Predict</button>
                            </div>
               </div>
          </div>
    </div>
  
    <br>
  
    <div id="resultdiv" style="display: none;" >
     
        
          <div class="text-center">
                <div class="card" id="predicted-data">
                      <div>
                        <span class="diseasefield" >Patient name : {{ user.patient.name }}</span>
                        <span class="diseasefield" >&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp Age : {{ user.patient.age }} </span>
                      </div>
                      <span class="diseasefield">The predicted disease is :  </span>
                      <span class="diseasefield" id="diseasefield" style="color: #092700; text-shadow: 2px 2px 4px rgb(36, 255, 45);"></span>                      
                      <br/>
                      <span class="diseasefield">Percentage that you might be suffered from this disease is:  </span>
                      <span>
                            <div class="progress" style="display: inline-block;width:140px">
                                <div id="percentage" class="progress-bar" style="width: 0%">0%
                                </div>
                            </div>
                      </span>
  
                </div>
            </div>
            
           
  
          <div class="text-center mt-4 mb-4"> 
                <button class="btn btn-outline-success">
                      <a id="href" href="https://www.google.com/search?q=anuj" target="_blank" rel="noopener noreferrer">Click here to know more about &nbsp 
                      <span id="diseasesearch" style="color: crimson;"></span></a>
                </button>
          </div>
            <br><br>
  
          <div class="text-center">
            <h4>This tool does not provide medical advice. It is intended for informational purposes only.
            </h4><h4>It is not a substitute for professional medical advice, diagnosis or treatment. 
            </h4>
          <br><br>
  
          </div>
  
  
  <div class="mx-auto text-center " style="width:350px">
    
    {% if user.is_authenticated %}
          <div > 
             <form action="consult_a_doctor" method="GET">
              {% csrf_token %} 
              <button id="consultbtn" type="submit" class="btn btn-primary"> Consult a <span id="consultdoctor"  name="consultdoctor" > </span> doctor</button>
            </form>
          </div>
          {% else %}
          <div > 
            <form action="consult_a_doctor" method="GET">
             {% csrf_token %} 
             <button id="consultbtn" type="submit" class="btn btn-primary"> Consult a <span id="consultdoctor"  name="consultdoctor" > </span> doctor</button>
           </form>
         </div>
         {% endif%}
          <br><br><br>
          <div >  
            <form action="related_hospital" method="GET">
            {% csrf_token %} 
           Related Hospital<br> <button id="hospitalbtn" type="submit" class="btn btn-primary"> <span id="hospital"  name="hospital" > </span> </button>
          </form>
        </div>
        <br><br><br>
        <div >  
          <form action="home_remedy" method="GET">
          {% csrf_token %} 
          <button id="remedybtn" type="submit" class="btn btn-primary">  <span id="remedy"  name="remedy" > </span></button>
        </form>
      </div>
          <br><br><br>

            
          
        
   
  </div>  
      </div>        
  </div>
</div>
</body>



{% endblock %}
